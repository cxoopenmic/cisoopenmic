<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>CISO Open Mic — Toronto Winter 2026 — Schedule</title>

<style>
:root{
  --bg:#05060a;
  --panel:#0b1020;
  --border:rgba(148,163,184,.22);
  --text:#f8fafc;
  --muted:#a7b0c0;
  --accent:#53336F;
  --ok:#22c55e;
  --warn:#fbbf24;
}
*{box-sizing:border-box}
body{
  margin:0;
  background: radial-gradient(circle at top, #0d1633, var(--bg));
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  overflow:hidden;
}
.wrap{
  height:100vh;
  display:flex;
  flex-direction:column;
  padding:22px 26px;
  gap:18px;
}
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.title{
  font-size:22px;
  font-weight:800;
}
.status{
  font-size:12px;
  opacity:.8;
}
.grid{
  flex:1;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}
.card{
  background:rgba(11,16,32,.92);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  overflow:hidden;
}
.block-title{
  font-weight:900;
  margin-bottom:10px;
  text-transform:uppercase;
  letter-spacing:.05em;
}
.slot{
  display:flex;
  gap:12px;
  padding:8px 0;
  border-bottom:1px solid rgba(148,163,184,.15);
}
.slot:last-child{border-bottom:none}
.rank{
  font-weight:900;
  background:rgba(83,51,111,.25);
  padding:4px 10px;
  border-radius:999px;
}
.name{
  font-weight:800;
}
.talk{
  font-size:14px;
  opacity:.85;
}
.loading{
  opacity:.7;
}
.error{
  color:#f87171;
}
.timeline{
  display:grid;
  grid-template-columns:120px 1fr;
  gap:6px 10px;
  font-size:15px;
}
.footer{
  font-size:12px;
  opacity:.6;
}
</style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <div class="title">Toronto Winter 2026 — Live Schedule</div>
    <div class="status" id="status">Loading…</div>
  </div>

  <div class="grid">
    <div class="card">
      <div class="block-title">Performance Block 1</div>
      <div id="block1" class="loading">Loading lineup…</div>
    </div>

    <div class="card">
      <div class="block-title">Performance Block 2</div>
      <div id="block2" class="loading">Loading lineup…</div>
    </div>

    <div class="card">
      <div class="block-title">Tonight</div>
      <div class="timeline">
        <div>5:00</div><div>Reception & Networking</div>
        <div>6:00</div><div>Performance Block 1</div>
        <div>6:45</div><div>Intermission</div>
        <div>7:00</div><div>Performance Block 2</div>
        <div>7:45</div><div>Judge Deliberation</div>
        <div>7:55</div><div>Awards</div>
      </div>
    </div>

    <div class="card">
      <div class="block-title">Sponsors</div>
      <div id="sponsors">Loading sponsors…</div>
    </div>
  </div>

  <div class="footer">
    Auto-refresh every 15 seconds
  </div>
</div>

<script>
const EVENT_ID = "event_toronto_2026_02_25";
const API = "https://cxoopenmic.com/api/crm/public/event-schedule?event_id=" + EVENT_ID;

function esc(s){
  return String(s||"")
    .replace(/&/g,"&amp;")
    .replace(/</g,"&lt;")
    .replace(/>/g,"&gt;")
    .replace(/"/g,"&quot;");
}

function renderSlot(p,i){
  return `
    <div class="slot">
      <div class="rank">#${esc(p.performance_order)}</div>
      <div>
        <div class="name">${esc(p.full_name||"Speaker TBD")}</div>
        <div class="talk">${esc(p.talk_title||"")}</div>
      </div>
    </div>
  `;
}

async function load(){
  const status = document.getElementById("status");
  try{
    const res = await fetch(API);
    const data = await res.json();

    if(!data.ok) throw new Error("Bad response");

    const perfs = data.performances||[];
    const b1 = perfs.filter(p=>Number(p.performance_block)===1);
    const b2 = perfs.filter(p=>Number(p.performance_block)===2);

    document.getElementById("block1").innerHTML =
      b1.length ? b1.map(renderSlot).join("") : "No speakers yet.";

    document.getElementById("block2").innerHTML =
      b2.length ? b2.map(renderSlot).join("") : "No speakers yet.";

    status.textContent = "Live";
  }catch(e){
    status.textContent = "Error loading schedule";
    status.classList.add("error");
  }
}

load();
setInterval(load,15000);
</script>
</body>
</html>
